{"ast":null,"code":"var _jsxFileName = \"D:\\\\skiliopay-paylater-mvp\\\\frontend\\\\src\\\\pages\\\\SelectUserPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { UserPicker } from \"../components/UserPicker\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function SelectUserPage() {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    fetch(\"http://localhost:3000/api/paylater/users\").then(async res => {\n      if (!res.ok) throw new Error(`Failed to load users: ${res.status}`);\n      return res.json();\n    }).then(data => {\n      setUsers(data);\n      setLoading(false);\n    }).catch(err => {\n      console.error(err);\n      setLoading(false);\n    });\n  }, []);\n\n  // NOTE: accept index too (UserPicker now passes (user_id, index))\n  const handleSelect = (user_id, index) => {\n    // store selected index so when user navigates back we can restore position\n    try {\n      localStorage.setItem(\"selected_user_index\", String(index));\n    } catch (e) {\n      // ignore localStorage failures in private mode, but don't block flow\n      console.warn(\"Could not persist selected index\", e);\n    }\n    fetch(`http://localhost:3000/api/paylater/users/${user_id}/carts`).then(async res => {\n      if (!res.ok) throw new Error(`Failed to load carts: ${res.status}`);\n      return res.json();\n    }).then(carts => {\n      if (!carts || carts.length === 0) {\n        alert(\"User has no carts\");\n        return;\n      }\n      const firstCart = carts[0];\n      const canContinue = firstCart.total_amount >= firstCart.eligible_threshold;\n\n      // Navigate to cart (keeps the same behavior you already had)\n      navigate(`/user/${user_id}/cart/${firstCart.cart_id}`, {\n        state: {\n          canContinue\n        }\n      });\n    }).catch(err => {\n      console.error(err);\n      alert(\"Failed to fetch carts. Check server or network.\");\n    });\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: \"#13444E\",\n        textAlign: \"center\",\n        marginTop: 80\n      },\n      children: \"Loading users...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      minHeight: \"100vh\",\n      background: \"#1C9085\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        alignItems: \"center\",\n        padding: \"16px\",\n        background: \"#16766D\",\n        boxShadow: \"0 2px 6px rgba(0,0,0,0.15)\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"/SkilioPayLogo.png\",\n        alt: \"logo\",\n        style: {\n          width: 70,\n          height: 100,\n          marginRight: 10,\n          marginLeft: 50\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          textAlign: \"center\",\n          color: \"#fff\",\n          fontSize: 22,\n          fontWeight: 700,\n          marginRight: 36 // để bù lại kích thước logo, giữ chữ đúng giữa\n        },\n        children: \"Select user\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        paddingTop: 20\n      },\n      children: /*#__PURE__*/_jsxDEV(UserPicker, {\n        users: users,\n        onSelect: handleSelect\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 3\n  }, this);\n}\n_s(SelectUserPage, \"Ix/DE3khS4OjX2js4xJ+a4aGY70=\", false, function () {\n  return [useNavigate];\n});\n_c = SelectUserPage;\nvar _c;\n$RefreshReg$(_c, \"SelectUserPage\");","map":{"version":3,"names":["React","useState","useEffect","UserPicker","useNavigate","jsxDEV","_jsxDEV","SelectUserPage","_s","users","setUsers","loading","setLoading","navigate","fetch","then","res","ok","Error","status","json","data","catch","err","console","error","handleSelect","user_id","index","localStorage","setItem","String","e","warn","carts","length","alert","firstCart","canContinue","total_amount","eligible_threshold","cart_id","state","style","color","textAlign","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","minHeight","background","display","flexDirection","alignItems","padding","boxShadow","src","alt","width","height","marginRight","marginLeft","flex","fontSize","fontWeight","paddingTop","onSelect","_c","$RefreshReg$"],"sources":["D:/skiliopay-paylater-mvp/frontend/src/pages/SelectUserPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { UserPicker } from \"../components/UserPicker\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\ntype User = {\r\n  user_id: string;\r\n  name: string;\r\n  timezone: string;\r\n  locale: string;\r\n};\r\n\r\ntype Cart = {\r\n  cart_id: string;\r\n  total_amount: number;\r\n  eligible_threshold: number;\r\n};\r\n\r\nexport default function SelectUserPage() {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:3000/api/paylater/users\")\r\n      .then(async (res) => {\r\n        if (!res.ok) throw new Error(`Failed to load users: ${res.status}`);\r\n        return res.json();\r\n      })\r\n      .then(data => {\r\n        setUsers(data);\r\n        setLoading(false);\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        setLoading(false);\r\n      });\r\n  }, []);\r\n\r\n  // NOTE: accept index too (UserPicker now passes (user_id, index))\r\n  const handleSelect = (user_id: string, index: number) => {\r\n    // store selected index so when user navigates back we can restore position\r\n    try {\r\n      localStorage.setItem(\"selected_user_index\", String(index));\r\n    } catch (e) {\r\n      // ignore localStorage failures in private mode, but don't block flow\r\n      console.warn(\"Could not persist selected index\", e);\r\n    }\r\n\r\n    fetch(`http://localhost:3000/api/paylater/users/${user_id}/carts`)\r\n      .then(async res => {\r\n        if (!res.ok) throw new Error(`Failed to load carts: ${res.status}`);\r\n        return res.json();\r\n      })\r\n      .then((carts: Cart[]) => {\r\n        if (!carts || carts.length === 0) {\r\n          alert(\"User has no carts\");\r\n          return;\r\n        }\r\n        const firstCart = carts[0];\r\n        const canContinue = firstCart.total_amount >= firstCart.eligible_threshold;\r\n\r\n        // Navigate to cart (keeps the same behavior you already had)\r\n        navigate(`/user/${user_id}/cart/${firstCart.cart_id}`, { state: { canContinue } });\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        alert(\"Failed to fetch carts. Check server or network.\");\r\n      });\r\n  };\r\n\r\n  if (loading) {\r\n  return (\r\n    <div style={{ color: \"#13444E\", textAlign: \"center\", marginTop: 80 }}>\r\n      Loading users...\r\n    </div>\r\n  );\r\n}\r\n\r\nreturn (\r\n  <div\r\n    style={{\r\n      minHeight: \"100vh\",\r\n      background: \"#1C9085\",\r\n      display: \"flex\",\r\n      flexDirection: \"column\"\r\n    }}\r\n  >\r\n    {/* HEADER */}\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        padding: \"16px\",\r\n        background: \"#16766D\",\r\n        boxShadow: \"0 2px 6px rgba(0,0,0,0.15)\"\r\n      }}\r\n    >\r\n      {/* LOGO LEFT */}\r\n      <img\r\n  src=\"/SkilioPayLogo.png\"\r\n  alt=\"logo\"\r\n  style={{ width: 70, height: 100, marginRight: 10, marginLeft: 50}}\r\n/>\r\n\r\n\r\n      {/* TITLE CENTERED */}\r\n      <div\r\n        style={{\r\n          flex: 1,\r\n          textAlign: \"center\",\r\n          color: \"#fff\",\r\n          fontSize: 22,\r\n          fontWeight: 700,\r\n          marginRight: 36 // để bù lại kích thước logo, giữ chữ đúng giữa\r\n        }}\r\n      >\r\n        Select user\r\n      </div>\r\n    </div>\r\n\r\n    {/* MAIN CONTENT */}\r\n    <div style={{ paddingTop: 20 }}>\r\n      <UserPicker users={users} onSelect={handleSelect} />\r\n    </div>\r\n  </div>\r\n);\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}